<!DOCTYPE html>
<html lang="en">
<head>
    <base target="_self">
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Air Quality Index (AQI) Checker</title>
    <meta name="description" content="Check real-time air quality index for any city, view historical data, and get health recommendations" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#e6f7ff',
                            100: '#b3e6ff',
                            200: '#80d4ff',
                            300: '#4dc3ff',
                            400: '#1ab1ff',
                            500: '#0095e6',
                            600: '#0077b3',
                            700: '#005980',
                            800: '#003b4d',
                            900: '#001d26',
                        },
                        aqiGood: '#00e400',
                        aqiModerate: '#ffff00',
                        aqiUnhealthySensitive: '#ff7e00',
                        aqiUnhealthy: '#ff0000',
                        aqiVeryUnhealthy: '#8f3f97',
                        aqiHazardous: '#7e0023'
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style>

    body {
      background: linear-gradient(to top, #87ceeb, #ffffff);
    }

        .aqi-badge {
            @apply px-3 py-1 rounded-full text-white font-medium text-sm;
        }
        .leaflet-container {
            @apply h-80 w-full rounded-xl z-0;
        }
        .chart-container {
            @apply bg-white p-4 rounded-xl shadow;
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">

<header class="bg-gradient-to-r from-primary-700 to-primary-500 text-white shadow-lg">
    <div class="container mx-auto px-4 py-6">
        <div class="flex flex-col md:flex-row justify-between items-center">
            <div class="mb-6 md:mb-0">
                <h1 class="text-3xl font-bold flex items-center">
                    <i class="fas fa-wind mr-3"></i>Air Care
                </h1>
                <p class="mt-2 opacity-90">Real-time air quality data and health recommendations</p>
            </div>
             <div class="flex items-center space-x-3 w-full md:w-auto">
        <div class="relative w-full md:w-80">
          <input
            type="text"
            id="citySearch"
            placeholder="Search for a city..."
            class="w-full py-3 px-4 pr-12 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-primary-300"
          />
          <button
            id="searchBtn"
            class="absolute right-3 top-3 text-primary-600"
          >
            <i class="fas fa-search"></i>
          </button>
        </div>

        <!-- LOGIN & SIGN UP BUTTONS -->
        <button
          class="bg-white text-primary-600 font-semibold px-4 py-2 rounded-lg hover:bg-primary-100 transition"
        >
          Login
        </button>
        <button
          class="bg-primary-600 text-white font-semibold px-4 py-2 rounded-lg hover:bg-primary-700 transition"
        >
          Sign Up
        </button>
      </div>
        </div>
    </div>
</header>

<main class="container mx-auto px-4 py-8">

    <section id="currentAqi" class="mb-12 bg-white rounded-xl shadow-lg p-6">
        <div class="flex flex-col md:flex-row justify-between items-center">
            <div class="mb-6 md:mb-0 md:w-1/2">
                <h2 class="text-2xl font-bold text-gray-800 mb-2">Current Air Quality</h2>
                <div class="flex items-center">
                    <div id="aqiValue" class="text-6xl font-bold mr-4">--</div>
                    <div>
                        <div id="aqiCategory" class="aqi-badge bg-gray-500">N/A</div>
                        <p id="cityName" class="text-gray-600 mt-2">Search for a city to see AQI data</p>
                    </div>
                </div>
                <div id="aqiDescription" class="mt-4 text-gray-700">
                    Air Quality Index information will appear here after searching for a city.
                </div>
            </div>
            <div class="w-full md:w-1/2">
                <div class="bg-gray-100 p-4 rounded-lg">
                    <h3 class="font-semibold text-lg mb-3">Health Recommendations</h3>
                    <div id="healthRecommendations" class="space-y-2">
                        <p class="text-gray-700">Search for a city to see personalized health recommendations</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
        <section class="chart-container">
            <h2 class="text-xl font-bold text-gray-800 mb-4">Last 7 Days PM2.5 Trend</h2>
            <canvas id="aqiChart"></canvas>
        </section>
         <section>
            <h2 class="text-xl font-bold text-gray-800 mb-4">Nearby City Location</h2>
            <div id="map" class="leaflet-container"></div>
        </section>
    </div>

    <section class="mb-12">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">Air Quality Awareness</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="bg-white rounded-xl shadow p-4">
                <h3 class="font-semibold text-lg mb-3">Understanding AQI Levels</h3>
                <div class="space-y-3">
                    <div class="flex items-center">
                        <div class="w-6 h-6 rounded-full bg-aqiGood mr-3"></div>
                        <div>
                            <span class="font-medium">Good (0-50):</span> 
                            <span>Air quality is satisfactory with little health risk.</span>
                        </div>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 rounded-full bg-aqiModerate mr-3"></div>
                        <div>
                            <span class="font-medium">Moderate (51-100):</span> 
                            <span>Acceptable quality, but some pollutants may affect sensitive individuals.</span>
                        </div>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 rounded-full bg-aqiUnhealthySensitive mr-3"></div>
                        <div>
                            <span class="font-medium">Unhealthy for Sensitive Groups (101-150):</span> 
                            <span>People with respiratory conditions should limit outdoor exertion.</span>
                        </div>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 rounded-full bg-aqiUnhealthy mr-3"></div>
                        <div>
                            <span class="font-medium">Unhealthy (151-200):</span> 
                            <span>Everyone may experience health effects; sensitive groups at greater risk.</span>
                        </div>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 rounded-full bg-aqiVeryUnhealthy mr-3"></div>
                        <div>
                            <span class="font-medium">Very Unhealthy (201-300):</span> 
                            <span>Health alert - everyone may experience more serious health effects.</span>
                        </div>
                    </div>
                    <div class="flex items-center">
                        <div class="w-6 h-6 rounded-full bg-aqiHazardous mr-3"></div>
                        <div>
                            <span class="font-medium">Hazardous (301+):</span> 
                            <span>Health warnings of emergency conditions affecting entire population.</span>
                        </div>
                    </div>
                </div>
            </div>

            <div>
                <h3 class="font-semibold text-lg mb-3">Educational Video</h3>
                <div class="bg-black aspect-video rounded-xl overflow-hidden">
                    <iframe 
                        class="w-full h-full" 
                        src="https://www.youtube.com/embed/PI3BerekReE" 
                        title="Understanding Air Quality Index" 
                        frameborder="0" 
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                        allowfullscreen>
                    </iframe>
                </div>
                <p class="mt-3 text-gray-700">Learn how the Air Quality Index works and how to protect yourself from air pollution.</p>
            </div>
        </div>
    </section>

</main>

<footer class="bg-gray-800 text-white py-10">
    <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            <div>
                <h3 class="text-xl font-bold mb-4">Air Quality Index Checker</h3>
                <p class="text-gray-400">Providing real-time air quality data and health recommendations to help you breathe easier.</p>
            </div>
            <div>
                <h4 class="font-semibold mb-4">Quick Links</h4>
                <ul class="space-y-2">
                    <li><a href="#" class="text-gray-400 hover:text-white transition">Home</a></li>
                    <li><a href="#" class="text-gray-400 hover:text-white transition">About AQI</a></li>
                    <li><a href="#" class="text-gray-400 hover:text-white transition">Health Resources</a></li>
                    <li><a href="#" class="text-gray-400 hover:text-white transition">Data Sources</a></li>
                </ul>
            </div>
            <div>
                <h4 class="font-semibold mb-4">Subscribe to Updates</h4>
                <div class="flex">
                    <input type="email" placeholder="Your email" class="px-4 py-2 w-full rounded-l-lg text-gray-800 focus:outline-none" />
                    <button class="bg-primary-500 hover:bg-primary-600 px-4 py-2 rounded-r-lg transition">Subscribe</button>
                </div>
                <p class="text-gray-400 text-sm mt-2">Get air quality alerts for your area</p>
            </div>
        </div>
        <div class="border-t border-gray-700 mt-8 pt-6 text-center text-gray-500">
            <p>&copy; 2023 Air Quality Index Checker. All data is for demonstration purposes only.</p>
        </div>
    </div>
</footer>

<script>
    const token = 'TERA_WAQI_API_TOKEN_YAHAN_DAL'; // Apna WAQI API token yahan daal
    const citySearch = document.getElementById('citySearch');
    const searchBtn = document.getElementById('searchBtn');
    const suggestions = document.getElementById('suggestions');

    const ctx = document.getElementById('aqiChart').getContext('2d');
    let aqiChart;

    // Initialize Leaflet map
    const map = L.map('map').setView([20, 0], 2);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    citySearch.addEventListener('input', function() {
        const searchTerm = this.value.toLowerCase();
        suggestions.innerHTML = '';
        suggestions.classList.add('hidden');
        if (searchTerm.length < 2) return;
        // Could implement autocomplete here (optional)
    });

    suggestions.addEventListener('click', function(e) {
        if (e.target.classList.contains('city-suggestion')) {
            const cityName = e.target.getAttribute('data-city');
            citySearch.value = cityName;
            suggestions.classList.add('hidden');
            fetchAndUpdateCityAQI(cityName);
        }
    });

    searchBtn.addEventListener('click', () => {
        const cityName = citySearch.value.trim();
        if (cityName) fetchAndUpdateCityAQI(cityName);
    });

    citySearch.addEventListener('keypress', function(e) {
        if (e.key === 'Enter' && citySearch.value.trim()) {
            fetchAndUpdateCityAQI(citySearch.value.trim());
        }
    });

    async function fetchAndUpdateCityAQI(cityName) {
        try {
            const response = await fetch(`https://api.waqi.info/feed/${cityName}/?token=${token}`);
            const data = await response.json();

            if (data.status !== 'ok') {
                alert('City not found or API limit reached');
                resetDisplay();
                return;
            }

            const aqi = data.data.aqi;
            document.getElementById('aqiValue').textContent = aqi;
            document.getElementById('cityName').textContent = data.data.city.name;
            document.getElementById('aqiCategory').textContent = getAqiCategory(aqi);
            document.getElementById('aqiCategory').className = 'aqi-badge ' + getAqiBadgeClass(aqi);
            document.getElementById('aqiDescription').textContent = getAqiDescription(aqi);
            document.getElementById('healthRecommendations').innerHTML = getHealthRecommendations(aqi);

            map.setView([data.data.city.geo[0], data.data.city.geo[1]], 10);
            L.marker([data.data.city.geo[0], data.data.city.geo[1]]).addTo(map);

            // Historical PM2.5 data (if available)
            let labels = [];
            let values = [];
            if (data.data.forecast && data.data.forecast.daily && data.data.forecast.daily.pm25) {
                const dailyData = data.data.forecast.daily.pm25.slice(0, 7);
                labels = dailyData.map(d => d.day);
                values = dailyData.map(d => d.avg);
            } else {
                labels = ['Today'];
                values = [aqi];
            }
            updateChart(labels, values);

        } catch (error) {
            console.error(error);
            alert('Error fetching AQI data');
            resetDisplay();
        }
    }

    function resetDisplay() {
        document.getElementById('aqiValue').textContent = '--';
        document.getElementById('cityName').textContent = 'Search for a city to see AQI data';
        document.getElementById('aqiCategory').textContent = 'N/A';
        document.getElementById('aqiCategory').className = 'aqi-badge bg-gray-500';
        document.getElementById('aqiDescription').textContent = 'Air Quality Index information will appear here after searching for a city.';
        document.getElementById('healthRecommendations').innerHTML = '<p class="text-gray-700">Search for a city to see personalized health recommendations</p>';
        if (aqiChart) {
            aqiChart.destroy();
        }
    }

    function updateChart(labels, data) {
        if (aqiChart) {
            aqiChart.destroy();
        }
        aqiChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: labels,
                datasets: [{
                    label: 'PM2.5 Levels',
                    data: data,
                    borderColor: '#0095e6',
                    backgroundColor: 'rgba(0,149,230,0.1)',
                    fill: true,
                    tension: 0.3,
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });
    }

    function getAqiCategory(aqi) {
        if (aqi <= 50) return 'Good';
        if (aqi <= 100) return 'Moderate';
        if (aqi <= 150) return 'Unhealthy for Sensitive Groups';
        if (aqi <= 200) return 'Unhealthy';
        if (aqi <= 300) return 'Very Unhealthy';
        return 'Hazardous';
    }

    function getAqiBadgeClass(aqi) {
        if (aqi <= 50) return 'bg-aqiGood';
        if (aqi <= 100) return 'bg-aqiModerate';
        if (aqi <= 150) return 'bg-aqiUnhealthySensitive';
        if (aqi <= 200) return 'bg-aqiUnhealthy';
        if (aqi <= 300) return 'bg-aqiVeryUnhealthy';
        return 'bg-aqiHazardous';
    }

    function getAqiDescription(aqi) {
        if (aqi <= 50) return 'Air quality is considered satisfactory, and air pollution poses little or no risk.';
        if (aqi <= 100) return 'Air quality is acceptable; however, there may be moderate health concern for sensitive individuals.';
        if (aqi <= 150) return 'Members of sensitive groups may experience health effects.';
        if (aqi <= 200) return 'Everyone may begin to experience health effects; sensitive groups more seriously.';
        if (aqi <= 300) return 'Health alert: everyone may experience more serious health effects.';
        return 'Health warning of emergency conditions: entire population is more likely to be affected.';
    }

    function getHealthRecommendations(aqi) {
        if (aqi <= 50) {
            return `<div class="flex items-start"><i class="fas fa-check-circle text-green-500 mr-2"></i><p>Ideal air quality for outdoor activities</p></div>`;
        }
        if (aqi <= 100) {
            return `<div class="flex items-start"><i class="fas fa-info-circle text-yellow-500 mr-2"></i><p>Unusually sensitive people should consider reducing prolonged outdoor exertion</p></div>`;
        }
        if (aqi <= 150) {
            return `<div class="flex items-start"><i class="fas fa-exclamation-triangle text-orange-500 mr-2"></i><p>Sensitive groups should reduce prolonged outdoor exertion</p></div><div class="flex items-start"><i class="fas fa-lungs text-orange-500 mr-2"></i><p>People with asthma should keep rescue inhaler handy</p></div>`;
        }
        if (aqi <= 200) {
            return `<div class="flex items-start"><i class="fas fa-exclamation-circle text-red-500 mr-2"></i><p>Sensitive groups should avoid prolonged outdoor exertion</p></div><div class="flex items-start"><i class="fas fa-wind text-red-500 mr-2"></i><p>Everyone else should limit prolonged outdoor exertion</p></div>`;
        }
        if (aqi <= 300) {
            return `<div class="flex items-start"><i class="fas fa-skull-crossbones text-purple-500 mr-2"></i><p>Sensitive groups should avoid all outdoor exertion</p></div><div class="flex items-start"><i class="fas fa-home text-purple-500 mr-2"></i><p>Everyone else should avoid prolonged outdoor exertion</p></div><div class="flex items-start"><i class="fas fa-air-freshener text-purple-500 mr-2"></i><p>Use air purifiers indoors and keep windows closed</p></div>`;
        }
        return `<div class="flex items-start"><i class="fas fa-radiation text-red-800 mr-2"></i><p>Everyone should avoid all outdoor exertion</p></div><div class="flex items-start"><i class="fas fa-house-user text-red-800 mr-2"></i><p>Remain indoors and keep activity levels low</p></div><div class="flex items-start"><i class="fas fa-head-side-mask text-red-800 mr-2"></i><p>Use N95 masks if going outside is necessary</p></div>`;
    }
</script>

</body>
</html>
